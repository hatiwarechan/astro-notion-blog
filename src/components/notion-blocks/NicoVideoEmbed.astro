---
export const isNicoVideoURL = (url: URL): boolean => {
  return /^https:\/\/(embed|www)\.nicovideo\.jp\/(watch|series|mylist)\/[a-z0-9]+/.test(url.toString())
}

export interface Props {
  url: string
}

const { url } = Astro.props

const nicoVideoUrl = new URL(url)
const isNico = isNicoVideoURL(nicoVideoUrl)

const iframeProps = {
  src: isNico
    ? `https://embed.nicovideo.jp/watch/${nicoVideoUrl.pathname.split('/').pop()}`
    : url,
  width: isNico ? '640' : '312',
  height: isNico ? '360' : '176',
  scrolling: 'no',
  style: {
    border: 'solid 1px #ccc',
    margin: '0 auto', // Add this line to center the iframe horizontally
  },
  frameborder: '0',
}
---

<div style="text-align: center;"> <!-- Add a centering container -->
  <iframe {...iframeProps} />
</div>

<style>
  @media (max-width: 840px) {
    iframe[src*="embed.nicovideo.jp/watch"] {
      width: 100%;
      max-width: 650px;
      height: 312px;
    }
  }
</style>
